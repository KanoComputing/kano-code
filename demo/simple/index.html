<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="ie=edge">
        <title>Simple Kano Code</title>
        <style>
            html, body {
                width: 100%;
                height: 100%;
                margin: 0;
                padding: 0;
            }
            kano-app-editor {
                width: 100%;
                height: 100%;
            }
        </style>
    </head>
    <body>
        <script type="module">
            import { Editor, AppModule } from '../../app/lib/index.js';
            import '../../node_modules/@kano/kwc-blockly/blockly_built/msg/js/en.js';

            class DrawModule extends AppModule {
                static get name() { return 'draw'; }
                constructor(...args) {
                    super(...args);
                    this.addMethod('square', '_square');
                }
                _square(x, y, w, h) {
                    const { outputView } = this.editor.workspaceView;
                    const canvas = outputView.root;
                    const ctx = canvas.getContext('2d');
                    ctx.fillStyle = 'red';
                    ctx.fillRect(x, y, w, h);
                }
            }

            const editor = new Editor();

            const DrawToolbox = {
                type: 'module',
                name: 'draw',
                color: '#00796b',
                symbols: [{
                    type: 'function',
                    name: 'square',
                    parameters: [{
                        name: 'x',
                        returnType: Number,
                        default: 0,
                    }, {
                        name: 'y',
                        returnType: Number,
                        default: 0,
                    }, {
                        name: 'width',
                        returnType: Number,
                        default: 100,
                    }, {
                        name: 'height',
                        returnType: Number,
                        default: 100,
                    }],
                }],
            };

            editor.toolbox.addEntry(DrawToolbox);
            editor.runner.addModule(DrawModule);

            editor.inject();
        </script>
    </body>
</html>