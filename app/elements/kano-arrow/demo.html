<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <script src="../../../bower_components/webcomponentsjs/webcomponents-lite.js"></script>
        <link rel="import" href="./kano-arrow.html">
        <style is="custom-style">
            kano-animated-svg {
                width: 30px;
                height: 30px;
                --kano-animated-path: {
                    transition: all linear 200ms;
                }
            }
            body {
                display: flex;
                flex-direction: row;
            }
            .row {
                display: flex;
                flex-direction: row;
            }
            .row span {
                width: 100px;
                height: 100px;
                margin: 2px;
                border: 1px solid grey;
                border-radius: 2px;
            }
            .row span.source {
                background-color: yellow;
            }
            .row span.target {
                background-color: red;
            }
            #target {
                display: inline-block;
                align-self: center;
            }
            .me-too {
                background-color: red;
                width: 30px;
                height: 30px;
            }
        </style>
    </head>
    <body>
        <template is="dom-bind" id="bind">
            <div class="pad" on-tap="elemClicked">
                <div class="row">
                    <span></span>
                    <span></span>
                    <span></span>
                    <span></span>
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
                <div class="row">
                    <span></span>
                    <span></span>
                    <span></span>
                    <span></span>
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
                <div class="row">
                    <span></span>
                    <span></span>
                    <span></span>
                    <span></span>
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
                <div class="row">
                    <span></span>
                    <span></span>
                    <span></span>
                    <span></span>
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
                <div class="row">
                    <span></span>
                    <span></span>
                    <span></span>
                    <span></span>
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
                <div class="row">
                    <span></span>
                    <span></span>
                    <span></span>
                    <span></span>
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </div>
            <div id="target">
                TARGET
            </div>
            <input type="range" name="name" value="{{angle::input}}" min="0" max="360">
            <kano-arrow source="[[source]]" target="[[target]]">
                <button type="button" name="button" class="arrow-image">I am an arrow</button>
            </kano-arrow>
            <kano-arrow target="[[target2]]" angle="[[angle]]">
                <img src="http://simpleicon.com/wp-content/uploads/arrow-31.svg" alt="" class="arrow-image" width="70"/>
            </kano-arrow>
        </template>
        <script>
            var bind = document.getElementById('bind'),
                source = true,
                prevSource,
                prevTarget;
            bind.addEventListener('dom-change', function () {
                bind.target2 = document.getElementById('target').getBoundingClientRect();
            });
            bind.elemClicked = function (e) {
                var rect = e.target.getBoundingClientRect();
                if (e.target.tagName !== 'SPAN') {
                    return;
                }
                if (source) {
                    bind.source = rect;
                    if (prevSource) {
                        prevSource.className = '';
                    }
                    e.target.className = 'source';
                    prevSource = e.target;
                } else {
                    bind.target = rect;
                    if (prevTarget) {
                        prevTarget.className = '';
                    }
                    e.target.className = 'target';
                    prevTarget = e.target;
                }
                source = !source;
            };
            bind.selected = 'start';
        </script>
    </body>
</html>
