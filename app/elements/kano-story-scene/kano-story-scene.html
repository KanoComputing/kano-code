<dom-module id="kano-story-scene">
    <style>
    :host {
        display: block;
        @apply(--layout-vertical);
    }
    :host * {
        @apply(--layout-flex);
    }
    </style>
    <template>
        <kano-view location="[[location]]"
                view-name="[[name]]"
                attributes="[[attributes]]"></kano-view>
    </template>
</dom-module>
<script type="text/javascript">
    window.Kano = window.Kano || {};
    Kano.SceneComponentBehavior = {

        properties: {
            scene: Object,
            value: () => {
                return {};
            }
        },

        finish () {
            this.fire('done');
        }

    };
    class KanoStoryScene {
        beforeRegister () {
            this.is = 'kano-story-scene';
            this.properties = {
                scene: {
                    type: Object,
                    value: () => {
                        return {}
                    }
                },
                location: {
                    type: String
                },
                name: {
                    type: String
                },
                attributes: {
                    type: Object,
                    computed: 'computeAttributes(scene.data.*)'
                }
            };
            this.observers = [
                'componentChanged(scene.component)'
            ];
        }
        computeAttributes () {
            return {
                scene: this.scene.data
            };
        }
        componentChanged () {
            if (!this.scene.component) {
                return {};
            }
            let splitted = this.scene.component.split('/');
            this.set('location', `assets/stories/${splitted[0]}`),
            this.set('name', `kano-scene-${splitted[1]}`);
        }
        sceneFinished () {
            this.fire('done');
        }
    }
    Polymer(KanoStoryScene);
</script>
