<dom-module id="kano-workspace-normal">
    <style>
        :host {
            display: block;
            width: 100%;
            height: 100%;
            background: #ffffff;
            box-shadow: 4px 4px 5px 0 rgba(0, 0, 0, 0.14);
            border-radius: 5px;
        }

        :host .hole {
            position: absolute;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background-color: #454545;
        }
        :host .hole.hidden {
            display: none;
        }
        :host .hole.hole-top-left {
            top: 5px;
            left: 5px;
        }
        :host .hole.hole-top-right {
            top: 5px;
            right: 5px;
        }
        :host .hole.hole-bottom-right {
            bottom: 5px;
            right: 5px;
        }
        :host .hole.hole-bottom-left {
            bottom: 5px;
            left: 5px;
        }

        :host ::content > *:not(.hole) {
            position: absolute;
            top: 0px;
            left: 0px
        }
        canvas {
            border-radius: 5px;
        }
    </style>
    <template>
        <canvas id="canvas" width$="[[width]]" height$="[[height]]"></canvas>
        <div class="hole hole-top-left"></div>
        <div class="hole hole-top-right"></div>
        <div class="hole hole-bottom-right"></div>
        <div class="hole hole-bottom-left"></div>
        <content></content>
    </template>
    <script>
        /* globals Polymer, Kano */
        Polymer({
            is: 'kano-workspace-normal',
            properties: {
                width: Number,
                height: Number,
                autoStart: Boolean
            },
            attached () {
                if (this.autoStart) {
                    this.start();
                }
            },
            setBackgroundColor (color) {
                this.style.background = color;
            },
            start () {
                this.reset();
            },
            reset () {
                this.ctx = this.$.canvas.getContext('2d');
                this.modules = new Kano.CanvasAPI({
                    ctx: this.ctx,
                    width: this.width,
                    height: this.height
                });
            },
            renderOnCanvas (ctx, util, scaleFactor) {
                var image = new Image();
                image.src = this.$.canvas.toDataURL();
                ctx.drawImage(image, 0, 0);
                return Promise.resolve();
            }
        });
    </script>
</dom-module>
