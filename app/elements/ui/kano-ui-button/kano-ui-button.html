<link rel="import" href="../behaviors.html">

<dom-module id="kano-ui-button">
    <style>
    :host {
        display: inline-block;
    }
    :host button {
        @apply(--kano-button-big);
        background: var(--color-green);
    }
    </style>
    <template>
        <button id="button"
                type="button"
                on-tap="buttonClicked"
                style$="[[computeButtonStyle(model.userStyle.*)]]">
            [[model.userProperties.label]]
        </button>
    </template>
</dom-module>

<script type="text/javascript">
    /* globals Polymer, KanoBehaviors */
    class KanoUiButton {
        get behaviors () {
            return [KanoBehaviors.UIBehavior];
        }
        beforeRegister () {
            this.is = 'kano-ui-button';
        }
        buttonClicked () {
            this.fire('clicked');
        }
        computeButtonStyle () {
            return this.getPartialStyle(['background-color', 'color']);
        }
        getLabel () {
            return this.get('model.userProperties.label');
        }
        setLabel (label) {
            this.set('model.userProperties.label', label);
        }
        setBackgroundColour (color) {
            this.set('model.userStyle.background-color', color);
        }
        setColour (color) {
            this.set('model.userStyle.color', color);
        }
        renderOnCanvas (ctx, util) {
            return KanoBehaviors.UIBehavior.renderOnCanvas.apply(this, arguments).then(() => {
                let button = this.$.button,
                    text = this.model.userProperties.label,
                    width = button.offsetWidth,
                    height = button.offsetHeight;

                ctx.fillStyle = this.model.userStyle['background-color'];
                ctx.fillRect(0, 0, width, height);

                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.font = `${util.getStyle(button, 'font-size')} ${util.getStyle(button, 'font-family')}`;
                ctx.fillStyle = 'white';
                ctx.fillText(text, width / 2, height / 2);

                ctx.stroke();
                ctx.restore();
            });
        }
    }
    Polymer(KanoUiButton);
</script>
