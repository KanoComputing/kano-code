<link rel="import" href="../../behaviors/kano-emitter-behavior.html">
<link rel="import" href="../../kano-style/typography.html">
<dom-module id='kano-ui-text'>
    <style>
        :host {
            display: inline-block;
        }
    </style>
    <template>
        <span id='label'
            on-tap="textClicked"
            style$='[[computeLabelStyle(model.userStyle.*)]]'>
            {{model.userProperties.text}}
        </span>
    </template>
</dom-module>

<script type="text/javascript">
    /* globals Polymer, Kano */

    Polymer({
        is: 'kano-ui-text',
        behaviors: [Kano.Behaviors.UIBehavior, Kano.Behaviors.EmitterBehavior],
        start () {
            Kano.Behaviors.UIBehavior.start.apply(this, arguments);
        },
        stop () {
            Kano.Behaviors.UIBehavior.stop.apply(this, arguments);
            Kano.Behaviors.EmitterBehavior.stop.apply(this, arguments);
        },
        computeLabelStyle () {
            return this.getPartialStyle(['font-size', 'color', 'font-family']);
        },
        setValue (value) {
            this.set('model.userProperties.text', value);
        },
        getValue () {
            return this.get('model.userProperties.text');
        },
        textClicked () {
            this.fire('clicked');
        },
        renderOnCanvas (ctx) {
            return Kano.Behaviors.UIBehavior.renderOnCanvas.apply(this, arguments).then(() => {
                let text = this.model.userProperties.text,
                    color = this.model.userStyle.color;

                ctx.textAlign = 'start';
                ctx.textBaseline = 'top';
                ctx.font = `${this.model.userStyle['font-size']} ${this.model.userStyle['font-family']}`;
                ctx.fillStyle = color;
                ctx.fillText(text, 0, 0);
                ctx.restore();
            });
        }
    });
</script>
