<dom-module id="kano-app-player">
    <style>
        :host {
          display: flex;
          align-items: center;
          @apply(--layout-horizontal);
        }
        :host ::content kano-user-component {
            @apply(--layout-flex);
        }
        #container {
            @apply(--layout-vertical);
            @apply(--layout-flex);
            @apply(--layout-center);
            @apply(--layout-center-justified);
            position: relative;
            height: calc(100% - 40px);
        }
        h1.error {
            color: var(--color-red);
        }
    </style>
    <template>
        <div id="container">
            <template is="dom-if" if="{{failed}}">
                <h1 class="error">Something went wrong :(</h1>
                <div>The app just won't run, will it?</div>
            </template>
        </div>
    </template>
    <script type="text/javascript">
        Polymer({
            is: 'kano-app-player',
            properties: {
                src: {
                    type: String,
                    observer: '_srcChanged'
                },
                failed: {
                    type: Boolean,
                    value:false
                }
            },
            _srcChanged () {
                if (!this.src) {
                    return;
                }
                this.importHref(this.src, this._onAppFileLoad.bind(this), this._onAppFileError.bind(this));
            },
            _onAppFileLoad () {
                let c = this.create('kano-user-component');
                this.appendChild(c);
                this.removeChild(this.$.container);
            },
            _onAppFileError (e) {
                this.failed = true;
            }
        });
    </script>
</dom-module>
