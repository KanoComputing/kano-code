<link rel="import" href="../inputs/kano-input/kano-input.html">
<dom-module id="kano-ui-customizer">
    <style>
    :host {
        display: block;
        @apply(--layout-vertical);
        @apply(--layout-start);
        transition: all linear 100ms;
    }
    :host .line {
        width: 100%;
        margin-top: 5px;
        @apply(--layout-vertical);
    }
    :host .line label {
        font-size: 1.1em;
        font-weight: 400;
        color: var(--color-grey-darker, grey);
    }
    </style>
    <template>
        <template is="dom-repeat"
                items="{{customizable}}"
                as="property">
            <div class="line">
                <kano-input id$="[[property.key]]"
                        type="{{property.type}}"
                        name="name"
                        label="{{property.label}}"
                        symbol="{{property.symbol}}"
                        on-value-changed="propertyChanged"
                        value$="[[computeValue(property.key)]]"
                        min="[[property.min]]"
                        max="[[property.max]]"
                        options="[[property.options]]">
                </kano-input>
            </div>
        </template>
    </template>
</dom-module>

<script type="text/javascript">
    /* globals Polymer */
    Polymer({
        is: 'kano-ui-customizer',
        properties: {
            userValues: {
                type: Object,
                notify: true
            },
            customizable: {
                type: Array,
                value: () => []
            }
        },
        propertyChanged (e) {
            let target = e.path ? e.path[0] : e.target;
            if (target.tagName !== 'KANO-INPUT') {
                return;
            }
            let propertyName = e.model.get('property.key');
            if (typeof(e.detail.value) == 'number') {
                if (propertyName == 'width' || propertyName == 'height') {
                      e.detail.value = `${e.detail.value.toString()}px`;
                } else if (propertyName == 'font-size') {
                      e.detail.value = `${e.detail.value.toString()}em`;
                }
            }
            this.set(`userValues.${propertyName}`, e.detail.value);
        },
        computeValue (propertyName) {
            return this.userValues[propertyName];
        }
    });
</script>
