<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/marked-element/marked-element.html">
<dom-module id="kano-editor-banner">
    <style>
        @keyframes button-enter {
            0% {
                opacity: 1;
                transform: scale(0);
            }
            100% {
                opacity: 1;
                transform: scale(1);
            }
        }
        :host {
            flex-direction: row;
            @apply --layout-horizontal;
            @apply --layout-center;
        }
        :host .content {
            @apply --layout-flex;
            @apply --layout-horizontal;
            @apply --layout-center;
        }
        :host .content .head {
            color: #888;
            font-size: 0.8em;
            margin-bottom: 5px;
        }
        :host .content .body {
            font-weight: bold;
            @apply --layout-flex;
        }
        :host iron-image {
            margin: 5px 20px;
            height: 60px;
            width: 60px;
        }
        :host .text {
            @apply --layout-vertical;
            @apply --layout-flex;
        }
        :host #button {
            @apply --kano-button;
            background-color: var(--color-green, green);
            margin-left: 10px;
            opacity: 0;
            margin: 0;
            padding: 0;
            animation-duration: 0.3s;
            animation-fill-mode: forwards;
            background-color: #50565A;
            box-sizing: border-box;
            color: white;
            text-shadow: none;
            padding: 12px 22px;
            margin-right: 20px;
        }
        :host button.animate {
            animation-name: button-enter;
        }
        .markdown-html p {
            margin: 0px;
        }
        [hidden] {
            display: none !important;
        }
    </style>
    <template>
        <iron-image src="[[imgSrc]]" alt="Judoka in a speech bubble" sizing="contain"></iron-image>
        <div class="content">
            <div class="text">
                <div class="head" hidden$="[[!head]]">
                    <marked-element markdown="[[head]]">
                        <div class="markdown-html"></div>
                    </marked-element>
                </div>
                <div class="body">
                    <marked-element markdown="[[text]]">
                        <div class="markdown-html"></div>
                    </marked-element>
                </div>
            </div>
            <button id="button" type="button" hidden$="[[!showButton]]" on-tap="_buttonTapped">[[buttonLabel]]</button>
        </div>
    </template>
</dom-module>

<script type="text/javascript">
    /* globals Polymer */

    Polymer({
        is: 'kano-editor-banner',
        properties: {
            head: {
                type: String,
                value: null
            },
            text: {
                type: String,
                value: null
            },
            imgSrc: {
                type: String,
                value: '/assets/avatar/judoka-face.svg'
            },
            buttonLabel: {
                type: String
            },
            showButton: {
                type: Boolean,
                value: false,
                observer: '_showButtonChanged'
            }
        },
        _buttonTapped () {
            this.fire('button-tapped');
        },
        _showButtonChanged (shown) {
            if (shown) {
                let buttonElement = this.$.button;
                this.toggleClass('animate', false, buttonElement);
                buttonElement.getBoundingClientRect();
                this.toggleClass('animate', true, buttonElement);
            }
        }
    });
</script>
