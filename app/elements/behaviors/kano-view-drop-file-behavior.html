<script type="text/javascript">
    
        window.Kano = window.Kano || {};
    
        window.Kano.Behaviors = window.Kano.Behaviors || {};
    
        // @polymerBehavior
        Kano.Behaviors.ViewDropFileBehavior = {
            attached () {
                this._onDragover = this._onDragover.bind(this);
                this._onDrop = this._onDrop.bind(this);
                this._onDragenter = this._onDragenter.bind(this);
                this._onDragleave = this._onDragleave.bind(this);
                this._bindEvents();
            },
            detached () {
                this._unbindEvents();
            },
            _bindEvents () {
                this.addEventListener('dragover', this._onDragover, false);
                this.addEventListener('drop', this._onDrop, false);
                this.addEventListener('dragenter', this._onDragenter, false);
                this.addEventListener('dragleave', this._onDragleave, false);
            },
            _unbindEvents () {
                this.removeEventListener('dragover', this._onDragover);
                this.removeEventListener('drop', this._onDrop);
                this.removeEventListener('dragenter', this._onDragenter);
                this.removeEventListener('dragleave', this._onDragleave);
            },
            _onDragover (e) {
                e.preventDefault();
                e.stopPropagation();
                e.dataTransfer.dropEffect = 'copy';
            },
            _onDrop (e) {
                let files, file;
                e.preventDefault();
                e.stopPropagation();
                this.toggleClass('dragging', false);
                this._animateDrop();
                files = e.dataTransfer.files;
                for (let i = 0; i < files.length; i++) {
                    file = files[i];
                    this._readFile(file)
                        .then(content => {
                            this._onFileDropped(content);
                        })
                        .catch(e => {
                            console.log(e);
                        });
                };
            },
            _onFileDropped () {},
            _readFile (f) {
                return new Promise((resolve, reject) => {
                    var reader = new FileReader();

                    reader.onload = () => {
                        resolve(reader.result);
                    };

                    reader.onerror = reject;

                    reader.readAsText(f);
                });
            },
            _onDragenter (e) {
                if (e.dataTransfer.effectAllowed === 'move') {
                    return;
                }
                this.toggleClass('dragging', true);
                this._animateDragEnter();
            },
            _onDragleave (e) {
                this.toggleClass('dragging', false);
                this._animateDragLeave();
            },
            _animateDragEnter () {},
            _animateDragLeave () {},
            _animateDrop () {}
        };
    
    </script>
    