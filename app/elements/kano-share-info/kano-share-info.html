<link rel="import" href="../../bower_components/iron-icon/iron-icon.html">
<link rel="import" href="./kano-share-info-icons.html">
<dom-module id="kano-share-info">
    <style>
        :host {
            font-size: 25px;
            margin: 4px 15px;
            @apply(--layout-horizontal);
        }
        :host .kano-link {
            text-decoration: none;
            color: white;
            font-weight: bold;
            margin-right: 20px;
            color: white;
            display: inline-block;
            font-size: 20px;
            vertical-align: middle;
            cursor: pointer;
        }
        iron-icon.liked {
            --iron-icon-fill-color: #ff5e5e;
        }
        @media screen and (max-width: 568px) {
            .kano-link.title {
                display: block;
            }
        }
        .kano-link:not(.title) {
            @apply(--layout-horizontal);
            @apply(--layout-center);
        }
    </style>
    <template>
        <a class="kano-link ellipsis title" href$="[[shareUrl]]">
            <span>{{share.title}}</span>
        </a>
        <a class="kano-link" href$="[[shareUrl]]">
            <iron-icon icon="share-info-icons:comment"></iron-icon>
            <span>{{share.comments_count}}</span>
        </a>
        <a class="kano-link" on-tap="_toggleLike">
            <iron-icon icon="share-info-icons:heart" class$="[[_computeLikeClass(liked)]]"></iron-icon>
            <span>{{likeCount}}</span>
        </a>
        <a class="kano-link" href$="[[shareUrl]]">
            <iron-icon icon="share-info-icons-view:view"></iron-icon>
            <span>{{share.views_count}}</span>
        </a>
    </template>
</dom-module>

<script>
    Polymer({
        is: 'kano-share-info',
        properties: {
            share: {
                type: Object,
                observer: '_shareChanged'
            },
            liked: {
                type: Boolean,
                value: false
            },
            worldUrl: String
        },
        _shareChanged () {
            if (!this.share) {
                return;
            }
            this.likeCount = this.share.likes.length;
            this.shareUrl = `${this.worldUrl}/shared/${this.share.slug}`;
        },
        _computeLikeClass (liked) {
            return liked ? 'liked' : '';
        },
        _toggleLike () {
            if (this.liked) {
                this.fire('unlike', this.share.id);
                this.likeCount--;
                this.liked = false;
            } else {
                this.fire('like', this.share.id);
                this.likeCount++;
                this.liked = true;
            }
        }
    });
</script>
