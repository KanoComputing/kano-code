<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/paper-dialog/paper-dialog.html">
<link rel="import" href="../../bower_components/neon-animation/animations/transform-animation.html">
<link rel="import" href="../kano-style/kano-style.html">

<!--

  `kano-challenge-completed-modal` is a confirmation dialog shown at the end of
  each challenge.

@group Kano Elements
@demo demo.html
-->

<dom-module id="kano-challenge-completed-modal">
    <style>
        :host {
            display: block;

            --paper-dialog-title: {
                font-family: 'Bariol', sans-serif;
                font-weight: bold;
                margin-bottom: 5px;
            }
        }
        :host paper-dialog {
            display: flex;
            flex-direction: row;

            border-radius: 3px;
            overflow: hidden;
        }
        :host .image {
            margin-top: 0px !important;
            width: 100px;

            display: flex;
            flex-direction: row;

            align-items: center;
            justify-content: center;

            font-family: 'Bariol', sans-serif;
            font-weight: bold;
        }
        :host .xp-num {
            background-color: var(--color-yellow);
        }
        :host .star {
            background-color: var(--color-grey-mid);
        }
        :host .star img {
            max-width: 80px;
        }
        :host .image .plus {
            font-size: 20px;
            margin-top: -5px;
            margin-right: -2px;
        }
        :host .image .amount {
            font-size: 50px;
        }
        :host .image .xp {
            font-size: 20px;
            margin-top: -5px;
        }
        :host .content {
            margin: 20px 40px 20px 0px !important;

            flex: 1;

            font-family: 'Bariol', sans-serif;
        }
        :host .content button {
            background-color: var(--color-green, green);
            @apply(--kano-button);
            padding: 12px 50px;
            font-size: 14px;
            border-radius: 3px;
        }
        :host .content button:hover {
            background-color: var(--color-lighter-green);
        }
        :host .content .small-text {
            font-size: 16px;
            margin-bottom: 10px;
        }
    </style>
    <template>
        <paper-dialog id="modal" opened="{{opened}}">
            <div class$="image {{computeImageClass(xp)}}">
                <template is="dom-if" if="{{xp}}">
                    <div class="plus">+</div>
                    <div class="amount">{{xp}}</div>
                    <div class="xp">XP</div>
                </template>
                <template is="dom-if" if="{{!xp}}">
                    <img src="/assets/challenge-completed-star.svg" alt="Star" />
                </template>
            </div>
            <div class="content">
                <h2>Challenge Completed</h2>
                <div class="small-text">
                    Nice work! <span hidden$="{{!xp}}">You've just earned {{xp}} XP.</span>
                </div>
                <button class="next" on-tap="close">GOT IT</button>
            </div>
        </paper-dialog>
    </template>
</dom-module>
<script>
    Polymer({
        is: 'kano-challenge-completed-modal',
        properties: {
            xp: {
                type: Number,
                value: null
            },
            opened: {
                type: Boolean,
                observer: 'openedChanged',
                notify: true
            }
        },
        ready () {
            this.$.modal.animationConfig = {
                entry: {
                    'name': 'transform-animation',
                    node: this.$.modal,
                    transofmOrigin: 'top',
                    transformFrom: `translateY(${window.screen.height}px)`,
                    transformTo: `none`,
                    timing: {
                        duration: 400,
                        easing: 'cubic-bezier(0.245, 0.125, 0.280, 1)'
                    }
                },
                exit: {
                    'name': 'transform-animation',
                    node: this.$.modal,
                    transofmOrigin: 'top',
                    transformFrom: `none`,
                    transformTo: `translateY(${window.screen.height}px)`,
                    timing: {
                        duration: 400,
                        easing: 'cubic-bezier(0.245, 0.125, 0.280, 1)'
                    }
                }
            };
        },
        open () {
            this.$.modal.open();
            this.previouslyOpened = true;
        },
        close () {
            this.$.modal.close();
        },
        openedChanged (opened) {
            if (this.previouslyOpened && !opened) {
                this.previouslyOpened = false;
                this.fire('close');
            }
        },
        computeImageClass (xp) {
            return xp ? 'xp-num' : 'star';
        }
    });
</script>
