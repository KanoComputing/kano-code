<link rel="import" href="./app-module.html">

<script>
    (function (Kano) {

        class MinecraftModule extends Kano.AppModules.AppModule {

            constructor () {
                super();

                let scriptTag = document.createElement('script');
                scriptTag.onload = () => {
                    new QWebChannel(qt.webChannelTransport, (channel) => {
                        this.channel = channel;
                    });
                };
                scriptTag.src = 'qrc:///qtwebchannel/qwebchannel.js';
                document.head.appendChild(scriptTag);

                this.addMethod('setBlocks', '_setBlocks');
            }

            /*
             * @param position Array Coordrinates where to place the block [x,y,z]
             * @param size Array     The size of the block created [x,y,z]
             * @param type String    Type of material for the block
             */
            _setBlocks (position, size, type) {
                if (this.channel) {
                    let minecraftComponent = this.channel.objects.minecraftComponent;
                    minecraftComponent.setBlocks(
                        position[0], position[1], position[2],
                        size[0], size[1], size[2],
                        type, 0
                    );
                }
                console.log(`BLOCK [${type}] pos(${position.x}, ${position.y}, ${position.z}) size(${size.x}, ${size.y}, ${size.z})`);
            }
        }

        Kano.AppModules.modules['minecraft'] = new MinecraftModule();

    })(window.Kano = window.Kano || {});
</script>
