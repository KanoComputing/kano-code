<link rel="import" href="./dongle-base.html">
<script>
    (function () {
        window.Kano = window.Kano || {};
        Kano.MakeApps = Kano.MakeApps || {};
        /**
         * @namespace Kano.MakeApps.PartsAPI
         */
        Kano.MakeApps.PartsAPI = Kano.MakeApps.PartsAPI || {};

        const GyroAccelerometer = {
            module: 'gyroAccelerometer',
            onCreated () {
                this._onAccelorometerDataChanged = this._onAccelorometerDataChanged.bind(this);
                this._onGyroDataChanged = this._onGyroDataChanged.bind(this);
                this.handlers = {
                    'gyro-data': this._onGyroDataChanged,
                    'accelerometer-data': this._onAccelorometerDataChanged,
                };
                Kano.MakeApps.PartsAPI.DongleBase.onCreated.apply(this);
            },
            start () {
                Kano.MakeApps.PartsAPI.DongleBase.start.apply(this, arguments);
                this.lastGyroVector = { x: 0, y: 0, z: 0 };
                this.lastAccelVector = { x: 0, y: 0, z: 0 };
            },
            getGyroData (axis) {
                return this.lastGyroVector[axis];
            },
            getAccelerometerData (axis) {
                return this.lastAccelVector[axis];
            },
            _onGyroDataChanged (e) {
                this.lastGyroVector = e;
                this.fire('gyro-accel-update');
            },
            _onAccelorometerDataChanged (e) {
                this.lastAccelVector = e;
                this.fire('gyro-accel-update');
            }
        };
        Kano.MakeApps.PartsAPI.GyroAccelerometer = Object.assign({}, Kano.MakeApps.PartsAPI.DongleBase, GyroAccelerometer);
        /**
         * @polymerBehavior
         */
        Kano.MakeApps.PartsAPI['gyro-accelerometer'] = Kano.MakeApps.PartsAPI.GyroAccelerometer;
    })();
</script>
