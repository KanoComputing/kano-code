<link rel="import" href="./base.html">
<script>
    (function (Kano) {
        let LightShape, PartsAPI;

        Kano.MakeApps = Kano.MakeApps || {};
        PartsAPI = Kano.MakeApps.PartsAPI = Kano.MakeApps.PartsAPI || {};

        LightShape = {
            PIXEL_SIZE: 27,
            start () {
                PartsAPI.Base.start.apply(this);
                this._updateLightboard();
            },
            move (x, y) {
                x *= this.PIXEL_SIZE;
                y *= this.PIXEL_SIZE;
                PartsAPI.Base.move.call(this, x, y);
                this._updateLightboard();
            },
            setX (x) {
                x *= this.PIXEL_SIZE;
                PartsAPI.Base.setX.call(this, x);
                this._updateLightboard();
            },
            setY (y) {
                y *= this.PIXEL_SIZE;
                PartsAPI.Base.setY.call(this, y);
                this._updateLightboard();
            },
            getWidth () {
                return null;
            },
            getHeight () {
                return null;
            },
            getX () {
                let width = this.getWidth();
                    newPos = Math.max(0, Math.floor(PartsAPI.Base.getX.apply(this) / this.PIXEL_SIZE));
                if (width) {
                    newPos = Math.min(this.BOARD_WIDTH - width, newPos);
                }
                return newPos;
            },
            getY () {
                let height = this.getHeight();
                    newPos = Math.max(0, Math.floor(PartsAPI.Base.getY.apply(this) / this.PIXEL_SIZE));
                if (height) {
                    newPos = Math.min(this.BOARD_HEIGHT - height, newPos);
                }
                return newPos;
            },
            _updateLightboard() {}
        };

        PartsAPI['light-shape'] = Object.assign({}, PartsAPI.Base, LightShape);
    })(window.Kano = window.Kano || {});
</script>