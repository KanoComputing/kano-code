<link rel="import" href="../../app-modules/app-modules.html">
<link rel="import" href="../../app-modules/mic.html">
<link rel="import" href="./base.html">
<script>
    (function (Kano) {
        let Microphone, PartsAPI;

        Kano.MakeApps = Kano.MakeApps || {};
        PartsAPI = Kano.MakeApps.PartsAPI = Kano.MakeApps.PartsAPI || {};

        Microphone = {
            start () {
                this.volume = Kano.AppModules.getModule('mic').volume;
            },
            stop () {
                Kano.AppModules.getModule('mic').removeListener('microphone:threshold');
            },
            onVolumeThreshold (value, over, callback) {
                Kano.AppModules.getModule('mic').on(`microphone:threshold:${value}`, function (e) {
                    callback();
                });
            },
            getvolume () {
                return Kano.AppModules.getModule('mic').getVolume();
            },
            getpitch () {
                return Kano.AppModules.getModule('mic').getPitch();
            }
        };

        // @polymerBehavior
        Kano.MakeApps.PartsAPI['microphone'] = Object.assign({}, PartsAPI.Base, Microphone);
    })(window.Kano = window.Kano || {});
</script>
