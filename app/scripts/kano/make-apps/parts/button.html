<link rel="import" href="./parts.html">
<link rel="import" href="./ui.html">
<script>
    (function (Kano) {
        let button = {
            partType: 'ui',
            type: 'button',
            label: 'Button',
            image: '/assets/part/button.svg',
            colour: '#3f51b5',
            customizable: {
                properties: [{
                    key: 'label',
                    type: 'text',
                    label: 'Label'
                }],
                style: ['background-color']
            },
            userProperties: {
                label: 'Click me'
            },
            userStyle: {
                'background-color': '#70C222'
            },
            events: [{
                label: 'is clicked',
                id: 'clicked'
            }],
            blocks: [{
                block: (ui) => {
                    return {
                        id: 'get_label',
                        lookup: 'getLabel()',
                        output: "String",
                        message0: `${ui.name}: label`
                    };
                },
                javascript: (ui) => {
                    return function () {
                        return [`devices.get('${ui.id}').getLabel()`];
                    };
                },
                pseudo: (ui) => {
                    return function () {
                        return [`${ui.id}.label`];
                    };
                }
            },{
                block: (ui) => {
                    return {
                        id: 'set_label',
                        lookup: 'setLabel(label)',
                        message0: `${ui.name}: set label to %1`,
                        args0: [{
                            type: "input_value",
                            name: "LABEL"
                        }],
                        previousStatement: null,
                        nextStatement: null
                    };
                },
                javascript: (ui) => {
                    return function (block) {
                        let label = Blockly.JavaScript.valueToCode(block, 'LABEL');
                        return `devices.get('${ui.id}').setLabel(${label});`;
                    };
                },
                pseudo: (ui) => {
                    return function (block) {
                        let label = Blockly.Pseudo.valueToCode(block, 'LABEL') || `''`;
                        return `${ui.id}.setLabel(${label});\n`;
                    };
                }
            },{
                block: (ui) => {
                    return {
                        id: 'set_background_colour',
                        lookup: 'setBackgroundColor(color)',
                        message0: `${ui.name}: set background colour to %1`,
                        args0: [{
                            type: "input_value",
                            name: "COLOUR",
                            check: "Colour"
                        }],
                        previousStatement: null,
                        nextStatement: null
                    };
                },
                javascript: (ui) => {
                    return function (block) {
                        let colour = Blockly.JavaScript.valueToCode(block, 'COLOUR');
                        return `devices.get('${ui.id}').setBackgroundColour(${colour});`;
                    };
                },
                pseudo: (ui) => {
                    return function (block) {
                        let colour = Blockly.Pseudo.valueToCode(block, 'COLOUR') || `'orange'`;
                        return `${ui.id}.setBackgroundColour(${colour});\n`;
                    };
                }
            },{
                block: (ui) => {
                    return {
                        id: 'set_text_colour',
                        lookup: 'setColor(color)',
                        message0: `${ui.name}: set text colour to %1`,
                        args0: [{
                            type: "input_value",
                            name: "COLOUR",
                            check: "Colour"
                        }],
                        previousStatement: null,
                        nextStatement: null
                    };
                },
                javascript: (ui) => {
                    return function (block) {
                        let colour = Blockly.JavaScript.valueToCode(block, 'COLOUR');
                        return `devices.get('${ui.id}').setColour(${colour});`;
                    };
                },
                pseudo: (ui) => {
                    return function (block) {
                        let colour = Blockly.Pseudo.valueToCode(block, 'COLOUR') || `'orange'`;
                        return `${ui.id}.setColour(${colour});\n`;
                    };
                }
            }]
        };
        Kano.MakeApps.Parts.registerPart(button);
    })(window.Kano = window.Kano || {});
</script>
